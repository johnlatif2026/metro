<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Metro Cairo Guide</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- AOS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

<style>
  body{
    font-family: "Segoe UI",Tahoma,Arial,sans-serif;
    background:#f5f7fb;
    transition:.25s ease;
  }
  .dark{
    background:#121212;
    color:#e6e6e6;
  }
  header{
    background:#0d6efd;
    color:#fff;
    padding:36px 12px;
    text-align:center
  }
  .card-hover{transition:transform .18s ease, box-shadow .18s ease;}
  .card-hover:hover{transform:translateY(-6px); box-shadow:0 10px 30px rgba(13,110,253,.12);}
  .section-title{font-weight:700}
  .small-muted{font-size:.95rem;color:#6c757d}
  .dark .small-muted{color:#aaa}
  @media(min-width:1200px){.container-max{max-width:1100px}}
</style>
</head>
<body id="body">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark" style="background:#0d6efd;">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">ğŸš‡ Metro Guide</a>

    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navMenu" class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li><a class="nav-link" href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a class="nav-link" href="#about">Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</a></li>
        <li>
          <button id="switchTheme" class="btn btn-light btn-sm ms-2">ğŸŒ™</button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<header id="home">
  <h1 class="mb-1">ğŸš‡ Ø®Ø±ÙŠØ·Ø© / Ø¯Ù„ÙŠÙ„ Ù…ØªØ±Ùˆ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</h1>
  <div class="small-muted">Ø³Ù‡Ù„ Ø±Ø­Ù„ØªÙƒ â€” Ø§Ø®ØªØ± Ù…Ø­Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©</div>
</header>

<div class="container container-max mt-4 mb-5">

  <!-- Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø© -->
  <div class="row g-3 mb-4">
    <div class="col-md-8">
      <div class="card p-3 card-hover" data-aos="fade-up">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h5 class="section-title mb-1">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…ØªØ±Ùˆ</h5>
            <div class="small-muted">Ø§Ø¶ØºØ· Ù„Ù„Ø¹Ø±Ø¶</div>
          </div>
          <div>
            <a class="btn btn-outline-primary"
              href="https://i.postimg.cc/x1bzXDr4/IMG-20251201-153808.jpg" target="_blank">ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø©</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ -->
  <div class="row g-4">

    <div class="col-lg-6">
      <div class="card p-3 card-hover" data-aos="fade-right">
        <h5 class="section-title">ğŸ” ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ</h5>

        <div class="row gy-2">
          <div class="col-6">
            <label>Ù…Ù† (Ø®Ø·)</label>
            <select id="fromLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ù…Ù† (Ù…Ø­Ø·Ø©)</label>
            <select id="fromStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ø®Ø·)</label>
            <select id="toLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ù…Ø­Ø·Ø©)</label>
            <select id="toStation" class="form-select"></select>
          </div>
        </div>

        <div class="d-grid mt-3">
          <button id="btnDetails" class="btn btn-primary">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
        </div>

        <hr>
        <div id="detailsResult"></div>
      </div>
    </div>

    <!-- Ø§Ø­Ø³Ø¨ Ù…Ø´ÙˆØ§Ø±Ùƒ -->
    <div class="col-lg-6">
      <div class="card p-3 card-hover" data-aos="fade-left">
        <h5 class="section-title">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©</h5>

        <div class="row gy-2">
          <div class="col-6">
            <label>Ù…Ù† (Ø®Ø·)</label>
            <select id="cFromLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ù…Ù† (Ù…Ø­Ø·Ø©)</label>
            <select id="cFromStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ø®Ø·)</label>
            <select id="cToLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ù…Ø­Ø·Ø©)</label>
            <select id="cToStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø®Ø§Øµ</label>
            <input id="people" type="number" value="1" min="1" class="form-control">
          </div>
        </div>

        <div class="d-grid mt-3">
          <button id="btnCalc" class="btn btn-success">Ø§Ø­Ø³Ø¨</button>
        </div>

        <hr>
        <div id="calcResult"></div>
      </div>
    </div>
  </div>

  <!-- ABOUT SECTION -->
  <div id="about" class="mt-5" data-aos="fade-up">
    <div class="card p-4 card-hover">
      <h3 class="section-title">â„¹ï¸ Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h3>
      <p>
        Metro Cairo Guide Ù‡Ùˆ Ù…Ø´Ø±ÙˆØ¹ ÙˆÙŠØ¨ ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ø±ÙƒØ§Ø¨ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³Ø§Ø±Ù‡Ù… Ø¯Ø§Ø®Ù„ Ù…ØªØ±Ùˆ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©ØŒ
        Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø± Ø§Ù„ØªØ°ÙƒØ±Ø©ØŒ ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ Ù„Ù„ÙˆØµÙˆÙ„.
      </p>
      <p>
        Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ Ø¯Ø¹Ù… Ù„ØºØªÙŠÙ†ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Bootstrap Ùˆ AOSØŒ ÙˆÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.
      </p>
    </div>
  </div>

</div>

<footer class="text-center py-3" style="background:#0d6efd;color:#fff;">
  Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© Metro Cairo Guide 2025
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>AOS.init();</script>

<script>
// =================
// Theme toggle
// =================
const bodyEl = document.getElementById("body");
const switchBtn = document.getElementById("switchTheme");
let dark = false;
switchBtn.onclick = ()=>{
  dark = !dark;
  if(dark){
    bodyEl.classList.add("dark");
    switchBtn.innerText = "â˜€ï¸";
  } else {
    bodyEl.classList.remove("dark");
    switchBtn.innerText = "ğŸŒ™";
  }
};

// =================
// Load data.json
// =================
let dataGlobal=null;
fetch('data.json')
.then(r=>r.json())
.then(d=>{
  dataGlobal=d;
  populateSelectors();
})
.catch(()=>alert("data.json ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"));

// =================
// Elements
// =================
const fromLine=document.getElementById("fromLine");
const toLine=document.getElementById("toLine");
const fromStation=document.getElementById("fromStation");
const toStation=document.getElementById("toStation");
const cFromLine=document.getElementById("cFromLine");
const cToLine=document.getElementById("cToLine");
const cFromStation=document.getElementById("cFromStation");
const cToStation=document.getElementById("cToStation");

const btnDetails=document.getElementById("btnDetails");
const detailsResult=document.getElementById("detailsResult");
const btnCalc=document.getElementById("btnCalc");
const calcResult=document.getElementById("calcResult");

// =================
// constants
// =================
const MIN_PER_ST = 2.3;
const MIN_PER_TR = 3;

function fare(n){
  if(n<=9)return 8;
  if(n<=16)return 10;
  if(n<=23)return 15;
  return 20;
}

// Fill line dropdowns
function populateSelectors(){
  dataGlobal.lines.forEach(l=>{
    let opt=`<option value="${l.id}">${l.name}</option>`;
    fromLine.insertAdjacentHTML("beforeend",opt);
    toLine.insertAdjacentHTML("beforeend",opt);
    cFromLine.insertAdjacentHTML("beforeend",opt);
    cToLine.insertAdjacentHTML("beforeend",opt);
  });
  fillStations(fromLine.value,fromStation);
  fillStations(toLine.value,toStation);
  fillStations(cFromLine.value,cFromStation);
  fillStations(cToLine.value,cToStation);
}

function fillStations(lineId,select){
  select.innerHTML='';
  let line=dataGlobal.lines.find(l=>l.id==lineId);
  line.stations.forEach(s=>{
    let o=document.createElement("option");
    o.value=s; o.textContent=s;
    select.appendChild(o);
  });
}

[fromLine,toLine,cFromLine,cToLine].forEach(el=>{
  el.onchange=()=>{
    if(el===fromLine)fillStations(el.value,fromStation);
    if(el===toLine)fillStations(el.value,toStation);
    if(el===cFromLine)fillStations(el.value,cFromStation);
    if(el===cToLine)fillStations(el.value,cToStation);
  }
});

// ======= route finding (Ù†ÙØ³ ÙƒÙˆØ¯Ùƒ Ø¨Ù„Ø§ Ø­Ø°Ù) =======
function findBestRoute(a,b,c,d){
  const lines=dataGlobal.lines;
  const L1=lines.find(x=>x.id===a);
  const L2=lines.find(x=>x.id===c);
  let s1=L1.stations.indexOf(b);
  let s2=L2.stations.indexOf(d);
  if(s1==-1||s2==-1)return null;
  if(a===c){
    return {stationsCount:Math.abs(s1-s2),transfers:[],pathSegments:[
      {lineId:a,fromIndex:s1,toIndex:s2,stationsCount:Math.abs(s1-s2)}
    ]};
  }
  let common=L1.stations.filter(s=>L2.stations.includes(s));
  if(common.length>0){
    let best=null;
    common.forEach(inter=>{
      let i1=L1.stations.indexOf(inter);
      let i2=L2.stations.indexOf(inter);
      let T=Math.abs(s1-i1)+Math.abs(s2-i2);
      if(!best||T<best.T)best={inter,i1,i2,T};
    });
    return{stationsCount:best.T,transfers:[best.inter],pathSegments:[
      {lineId:a,fromIndex:s1,toIndex:best.i1,stationsCount:Math.abs(s1-best.i1)},
      {lineId:c,fromIndex:best.i2,toIndex:s2,stationsCount:Math.abs(s2-best.i2)}
    ]};
  }
  return null;
}

// ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ
btnDetails.onclick=()=>{
  const r=findBestRoute(fromLine.value,fromStation.value,toLine.value,toStation.value);
  if(!r){detailsResult.innerHTML="âŒ";return;}
  let t=(r.stationsCount*MIN_PER_ST)+(r.transfers.length*MIN_PER_TR);
  let c=fare(r.stationsCount);
  detailsResult.innerHTML=`
    <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª:</b> ${r.stationsCount}</p>
    <p><b>Ø§Ù„ØªØ¨Ø¯ÙŠÙ„Ø§Øª:</b> ${r.transfers.length?r.transfers.join(" âœ "):"Ù„Ø§ ÙŠÙˆØ¬Ø¯"}</p>
    <p><b>Ø§Ù„ÙˆÙ‚Øª:</b> ${t.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</p>
    <p><b>Ø§Ù„Ø³Ø¹Ø±:</b> ${c} Ø¬Ù†ÙŠÙ‡</p>
  `;
};

// Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©
btnCalc.onclick=()=>{
  const r=findBestRoute(cFromLine.value,cFromStation.value,cToLine.value,cToStation.value);
  if(!r){calcResult.innerHTML="âŒ";return;}
  let p=parseInt(people.value)||1;
  let t=(r.stationsCount*MIN_PER_ST)+(r.transfers.length*MIN_PER_TR);
  let c=fare(r.stationsCount);
  calcResult.innerHTML=`
    <p><b>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª:</b> ${r.stationsCount}</p>
    <p><b>Ø§Ù„ÙˆÙ‚Øª:</b> ${t.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</p>
    <p><b>Ø§Ù„ØªØ°ÙƒØ±Ø©:</b> ${c} Ø¬Ù†ÙŠÙ‡</p>
    <p><b>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù„ ${p}:</b> ${c*p} Ø¬Ù†ÙŠÙ‡</p>
  `;
};
</script>
</body>
</html>
