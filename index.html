<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Metro Cairo Guide</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- AOS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">

<style>
  body{
    font-family: "Segoe UI",Tahoma,Arial,sans-serif;
    background:#f5f7fb;
    transition:.25s ease;
  }
  .dark{
    background:#121212;
    color:#e6e6e6;
  }
  header{
    background:#0d6efd;
    color:#fff;
    padding:36px 12px;
    text-align:center
  }
  .card-hover{transition:transform .18s ease, box-shadow .18s ease;}
  .card-hover:hover{transform:translateY(-6px); box-shadow:0 10px 30px rgba(13,110,253,.12);}
  .section-title{font-weight:700}
  .small-muted{font-size:.95rem;color:#6c757d}
  .dark .small-muted{color:#aaa}
  @media(min-width:1200px){.container-max{max-width:1100px}}
</style>
</head>
<body id="body">

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark" style="background:#0d6efd;">
  <div class="container">
    <a class="navbar-brand fw-bold" href="#">ğŸš‡ Metro Guide</a>

    <button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navMenu">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navMenu" class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">
        <li><a class="nav-link" href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a class="nav-link" href="#about">Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</a></li>
        <li>
          <button id="switchTheme" class="btn btn-light btn-sm ms-2">ğŸŒ™</button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<header id="home">
  <h1 class="mb-1">ğŸš‡ Ø®Ø±ÙŠØ·Ø© / Ø¯Ù„ÙŠÙ„ Ù…ØªØ±Ùˆ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</h1>
  <div class="small-muted">Ø³Ù‡Ù„ Ø±Ø­Ù„ØªÙƒ â€” Ø§Ø®ØªØ± Ù…Ø­Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©</div>
</header>

<div class="container container-max mt-4 mb-5">

  <!-- Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø© -->
  <div class="row g-3 mb-4">
    <div class="col-md-8">
      <div class="card p-3 card-hover" data-aos="fade-up">
        <div class="d-flex justify-content-between align-items-center">
          <div>
            <h5 class="section-title mb-1">Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…ØªØ±Ùˆ</h5>
            <div class="small-muted">Ø§Ø¶ØºØ· Ù„Ù„Ø¹Ø±Ø¶</div>
          </div>
          <div>
            <a class="btn btn-outline-primary"
              href="https://i.postimg.cc/x1bzXDr4/IMG-20251201-153808.jpg" target="_blank">ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø©</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ -->
  <div class="row g-4">

    <div class="col-lg-6">
      <div class="card p-3 card-hover" data-aos="fade-right">
        <h5 class="section-title">ğŸ” ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ</h5>

        <div class="row gy-2">
          <div class="col-6">
            <label>Ù…Ù† (Ø®Ø·)</label>
            <select id="fromLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ù…Ù† (Ù…Ø­Ø·Ø©)</label>
            <select id="fromStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ø®Ø·)</label>
            <select id="toLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ù…Ø­Ø·Ø©)</label>
            <select id="toStation" class="form-select"></select>
          </div>
        </div>

        <div class="d-grid mt-3">
          <button id="btnDetails" class="btn btn-primary">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
        </div>

        <hr>
        <div id="detailsResult"></div>
      </div>
    </div>

    <!-- Ø§Ø­Ø³Ø¨ Ù…Ø´ÙˆØ§Ø±Ùƒ -->
    <div class="col-lg-6">
      <div class="card p-3 card-hover" data-aos="fade-left">
        <h5 class="section-title">ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©</h5>

        <div class="row gy-2">
          <div class="col-6">
            <label>Ù…Ù† (Ø®Ø·)</label>
            <select id="cFromLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ù…Ù† (Ù…Ø­Ø·Ø©)</label>
            <select id="cFromStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ø®Ø·)</label>
            <select id="cToLine" class="form-select"></select>
          </div>
          <div class="col-6">
            <label>Ø¥Ù„Ù‰ (Ù…Ø­Ø·Ø©)</label>
            <select id="cToStation" class="form-select"></select>
          </div>

          <div class="col-6">
            <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø®Ø§Øµ</label>
            <input id="people" type="number" value="1" min="1" class="form-control">
          </div>
        </div>

        <div class="d-grid mt-3">
          <button id="btnCalc" class="btn btn-success">Ø§Ø­Ø³Ø¨</button>
        </div>

        <hr>
        <div id="calcResult"></div>
      </div>
    </div>
  </div>

  <!-- ABOUT SECTION -->
  <div id="about" class="mt-5" data-aos="fade-up">
    <div class="card p-4 card-hover">
      <h3 class="section-title">â„¹ï¸ Ø¹Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h3>
      <p>
        Metro Cairo Guide Ù‡Ùˆ Ù…Ø´Ø±ÙˆØ¹ ÙˆÙŠØ¨ ÙŠØ³Ø§Ø¹Ø¯ Ø§Ù„Ø±ÙƒØ§Ø¨ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³Ø§Ø±Ù‡Ù… Ø¯Ø§Ø®Ù„ Ù…ØªØ±Ùˆ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© Ø¨Ø³Ù‡ÙˆÙ„Ø©ØŒ
        Ø­Ø³Ø§Ø¨ Ø³Ø¹Ø± Ø§Ù„ØªØ°ÙƒØ±Ø©ØŒ ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª ÙˆØ§Ù„ÙˆÙ‚Øª Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ Ù„Ù„ÙˆØµÙˆÙ„.
      </p>
      <p>
        Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø³ÙŠØ·Ø©ØŒ Ø¯Ø¹Ù… Ù„ØºØªÙŠÙ†ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Bootstrap Ùˆ AOSØŒ ÙˆÙŠØ¯Ø¹Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.
      </p>
    </div>
  </div>

</div>

<footer class="text-center py-3" style="background:#0d6efd;color:#fff;">
  Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© Metro Cairo Guide 2025
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>AOS.init();</script>


<script>
// =========================
// ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø·Ø§Øª
// =========================
let dataGlobal = null;
fetch('data.json')
.then(res=>res.json())
.then(d=>{
  dataGlobal=d;
  populateSelectors();
})
.catch(()=>alert("Ù…Ù„Ù data.json ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"));

// =========================
// Ø¹Ù†Ø§ØµØ± DOM
// =========================
const fromLine=document.getElementById("fromLine");
const toLine=document.getElementById("toLine");
const fromStation=document.getElementById("fromStation");
const toStation=document.getElementById("toStation");

const cFromLine=document.getElementById("cFromLine");
const cToLine=document.getElementById("cToLine");
const cFromStation=document.getElementById("cFromStation");
const cToStation=document.getElementById("cToStation");

const btnDetails=document.getElementById("btnDetails");
const detailsResult=document.getElementById("detailsResult");

const btnCalc=document.getElementById("btnCalc");
const calcResult=document.getElementById("calcResult");
const people=document.getElementById("people");

// =========================
// Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆÙ‚Øª Ùˆ Ø³Ø¹Ø±
// =========================
const MIN_PER_ST = 2.5;
const MIN_PER_TR = 3;

// Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª
function fare(n){
  if(n<=9)return 6;
  if(n<=16)return 8;
  if(n<=26)return 12;
  return 15;
}

// =========================
// Ù…Ù„Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
// =========================
function populateSelectors(){
  dataGlobal.lines.forEach(line=>{
    let opt=`<option value="${line.id}">${line.name}</option>`;
    fromLine.insertAdjacentHTML("beforeend",opt);
    toLine.insertAdjacentHTML("beforeend",opt);
    cFromLine.insertAdjacentHTML("beforeend",opt);
    cToLine.insertAdjacentHTML("beforeend",opt);
  });

  fillStations(fromLine.value,fromStation);
  fillStations(toLine.value,toStation);
  fillStations(cFromLine.value,cFromStation);
  fillStations(cToLine.value,cToStation);
}

function fillStations(lineId,select){
  select.innerHTML="";
  let line = dataGlobal.lines.find(l=>l.id==lineId);
  line.stations.forEach(s=>{
    let o=document.createElement("option");
    o.value=s; o.textContent=s;
    select.appendChild(o);
  });
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­Ø·Ø§Øª Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ø·
[fromLine,toLine,cFromLine,cToLine].forEach(el=>{
  el.onchange=()=>{
    if(el===fromLine)fillStations(el.value,fromStation);
    if(el===toLine)fillStations(el.value,toStation);
    if(el===cFromLine)fillStations(el.value,cFromStation);
    if(el===cToLine)fillStations(el.value,cToStation);
  }
});

// =========================
// ğŸ”¥ Ø£Ù‚ÙˆÙ‰ Ø­Ù„ Ù„Ù…Ø´ÙƒÙ„Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ø­Ø·Ø§Øª
// =========================
//
// â€” Ù„Ùˆ Ù†ÙØ³ Ø§Ù„Ø®Ø· â†’ Ø§Ù„ÙØ±Ù‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ø¨ÙŠÙ† index Ø§Ù„Ù…Ø­Ø·ØªÙŠÙ†
// â€” Ù„Ùˆ Ø®Ø·ÙˆØ· Ù…Ø®ØªÙ„ÙØ© â†’ Ù†Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù…Ø­Ø·Ø© ØªØ¨Ø¯ÙŠÙ„ Ù…Ø´ØªØ±ÙƒØ©
//
// =========================
function findRoute(startLineId,startStation,endLineId,endStation){

  const lines = dataGlobal.lines;
  let L1 = lines.find(l=>l.id===startLineId);
  let L2 = lines.find(l=>l.id===endLineId);

  let i1 = L1.stations.indexOf(startStation);
  let i2 = L2.stations.indexOf(endStation);

  if(i1===-1 || i2===-1) return null;

  // Ù†ÙØ³ Ø§Ù„Ø®Ø·
  if(startLineId===endLineId){
    let count = Math.abs(i1-i2);
    return {count, transfers:[], path:[
      {line:startLineId, from:i1, to:i2}
    ]};
  }

  // Ø®Ø·ÙˆØ· Ù…Ø®ØªÙ„ÙØ© â†’ Ù†Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­Ø·Ø§Øª Ù…Ø´ØªØ±ÙƒØ©
  let common = L1.stations.filter(s => L2.stations.includes(s));

  if(common.length===0) return null;

  let best = null;
  common.forEach(inter=>{
    let x1 = L1.stations.indexOf(inter);
    let x2 = L2.stations.indexOf(inter);
    let total = Math.abs(i1-x1)+Math.abs(i2-x2);
    if(!best || total<best.total){
      best = { inter, x1, x2, total };
    }
  });

  return{
    count: best.total,
    transfers: [best.inter],
    path:[
      {line:startLineId, from:i1, to:best.x1},
      {line:endLineId, from:best.x2, to:i2}
    ]
  };
}

// =========================
// ğŸ” ØªÙØ§ØµÙŠÙ„ Ù…Ø´ÙˆØ§Ø±Ùƒ
// =========================
btnDetails.onclick=()=>{
  const route = findRoute(fromLine.value,fromStation.value,toLine.value,toStation.value);
  if(!route){
    detailsResult.innerHTML="âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„";
    return;
  }

  let minutes = route.count * MIN_PER_ST + route.transfers.length * MIN_PER_TR;
  let price = fare(route.count);

  detailsResult.innerHTML=`
    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª: <b>${route.count}</b></p>
    <p>Ø§Ù„ØªØ¨Ø¯ÙŠÙ„: <b>${route.transfers.length?route.transfers.join(" â†’ "):"Ù„Ø§ ÙŠÙˆØ¬Ø¯"}</b></p>
    <p>Ø§Ù„ÙˆÙ‚Øª: <b>${minutes.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</b></p>
    <p>Ø³Ø¹Ø± Ø§Ù„ØªØ°ÙƒØ±Ø©: <b>${price} Ø¬Ù†ÙŠÙ‡</b></p>
  `;
};

// =========================
// ğŸ§® Ø§Ø­Ø³Ø¨ Ø§Ù„ØªÙƒÙ„ÙØ©
// =========================
btnCalc.onclick=()=>{
  const route = findRoute(cFromLine.value,cFromStation.value,cToLine.value,cToStation.value);
  if(!route){
    calcResult.innerHTML="âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„";
    return;
  }

  let p = parseInt(people.value)||1;
  let minutes = route.count * MIN_PER_ST + route.transfers.length * MIN_PER_TR;
  let price = fare(route.count);

  calcResult.innerHTML=`
    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø·Ø§Øª: <b>${route.count}</b></p>
    <p>Ø§Ù„ÙˆÙ‚Øª: <b>${minutes.toFixed(1)} Ø¯Ù‚ÙŠÙ‚Ø©</b></p>
    <p>Ø§Ù„Ø³Ø¹Ø± Ù„Ø´Ø®Øµ: <b>${price} Ø¬Ù†ÙŠÙ‡</b></p>
    <p>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù„ ${p}: <b>${price*p} Ø¬Ù†ÙŠÙ‡</b></p>
  `;
};
</script>
</body>
</html>
